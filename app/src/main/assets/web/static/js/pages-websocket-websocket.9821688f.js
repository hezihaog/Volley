(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-websocket-websocket"],{"0782":function(t,n,e){"use strict";e.d(n,"b",(function(){return o})),e.d(n,"c",(function(){return i})),e.d(n,"a",(function(){}));var o=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("v-uni-view",[e("v-uni-view",[e("v-uni-view",{staticClass:"connect-status"},[t.connected?e("v-uni-view",{staticStyle:{color:"green"}},[t._v("连接状态：已连接")]):e("v-uni-view",{staticStyle:{color:"red"}},[t._v("连接状态：未连接")])],1),e("v-uni-view",{staticClass:"uni-flex uni-column"},[e("v-uni-view",{staticClass:"websocket-msg",staticStyle:{"-webkit-flex":"1",flex:"1","white-space":"pre-wrap"}},[t._v(t._s(t.showMsg))]),e("v-uni-view",{staticClass:"uni-flex uni-row input-bar"},[e("v-uni-view",{staticClass:"text",staticStyle:{"-webkit-flex":"1",flex:"1"}},[e("v-uni-input",{staticClass:"uni-input user-input",attrs:{focus:!0,placeholder:"请输入你要发送的消息"},model:{value:t.userInput,callback:function(n){t.userInput=n},expression:"userInput"}})],1),e("v-uni-view",{staticClass:"text",staticStyle:{width:"200rpx"}},[e("v-uni-button",{staticClass:"send-btn",attrs:{type:"primary",size:"mini"},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.send.apply(void 0,arguments)}}},[t._v("发送")])],1)],1)],1)],1)],1)},i=[]},"2bf2":function(t,n,e){var o=e("24fb");n=o(!1),n.push([t.i,".text[data-v-67922fb7]{display:inline}.connect-status[data-v-67922fb7]{width:100%;display:block;position:fixed;background-color:#fff;height:%?50?%;padding-top:%?20?%;padding-bottom:%?10?%;padding-left:%?30?%;border-top:#eee solid %?1?%;border-bottom:#eee solid %?1?%}.websocket-msg[data-v-67922fb7]{margin:0 %?100?% %?100?% %?30?%;padding-top:%?80?%;text-align:left;font-size:14px;line-height:30px;color:#666}.input-bar[data-v-67922fb7]{width:100%;position:fixed;bottom:0;left:0;padding-top:%?20?%;padding-bottom:%?20?%;background-color:#fff;border:#bbb solid 1px}.user-input[data-v-67922fb7]{float:left;padding:0 20px 0 20px;display:inline-block;vertical-align:middle;text-align:left}.send-btn[data-v-67922fb7]{width:%?200?%;float:right;margin-right:%?20?%;display:inline-block;vertical-align:middle}",""]),t.exports=n},"909a":function(t,n,e){"use strict";var o=e("9794"),i=e.n(o);i.a},9794:function(t,n,e){var o=e("2bf2");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var i=e("4f06").default;i("24e6ede0",o,!0,{sourceMap:!1,shadowMode:!1})},c0bb:function(t,n,e){"use strict";e.r(n);var o=e("0782"),i=e("e858");for(var s in i)["default"].indexOf(s)<0&&function(t){e.d(n,t,(function(){return i[t]}))}(s);e("909a");var c=e("f0c5"),a=Object(c["a"])(i["default"],o["b"],o["c"],!1,null,"67922fb7",null,!1,o["a"],void 0);n["default"]=a.exports},d83c:function(t,n,e){"use strict";e("7a82");var o=e("4ea4").default;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,e("e9c4"),e("14d9"),e("d401"),e("d3b7"),e("25f0");var i=o(e("e7de")),s=(uni.getSystemInfoSync().platform,{data:function(){return{connected:!1,connecting:!1,socketTask:!1,msg:!1,msgList:[],userInput:""}},computed:{showMsg:function(){return this.connected&&this.msg?this.msgList.join("\n"):""}},onLoad:function(t){var n=this,e=t.ip;if(e)n.connect(e);else{var o=i.default.domain+"/common/getIpInfo";uni.request({url:o,method:"GET",success:function(t){console.log("通过接口获取IP："+JSON.stringify(t.data)),e=t.data.data,n.connect(e)},fail:function(){e="127.0.0.1",n.connect(e)}})}},onUnload:function(){uni.hideLoading(),this.socketTask&&this.socketTask.close&&this.socketTask.close()},methods:{connect:function(t){var n=this;if(this.connected||this.connecting)return uni.showModal({content:"正在连接或者已经连接，请勿重复连接",showCancel:!1}),!1;this.connecting=!0,uni.showLoading({title:"连接中..."}),this.socketTask=uni.connectSocket({url:"ws://"+t+":9001/ws",data:function(){return{msg:"Hello"}},success:function(t){},fail:function(t){}}),console.log(this.socketTask),this.socketTask.onOpen((function(t){n.connecting=!1,n.connected=!0,uni.hideLoading(),uni.showToast({icon:"none",title:"连接成功"}),console.log("onOpen",t)})),this.socketTask.onError((function(t){n.connecting=!1,n.connected=!1,uni.hideLoading(),uni.showModal({content:"连接失败，可能是websocket服务不可用，请稍后再试",showCancel:!1}),console.log("onError",t)})),this.socketTask.onMessage((function(t){n.msg=t.data,n.msgList.push("服务器："+t.data),console.log("onMessage",t)})),this.socketTask.onClose((function(t){n.connected=!1,n.startRecive=!1,n.socketTask=!1,n.msg=!1,console.log("onClose",t)})),console.log("task",this.socketTask)},send:function(){var t=this;this.userInput?this.socketTask.send({data:this.userInput.toString(),success:function(n){t.msgList.push("我："+t.userInput),t.userInput="",console.log(n)},fail:function(t){console.log(t)}}):uni.showToast({icon:"none",title:"请输入你要发送的消息内容"})},close:function(){(void 0).socketTask&&(void 0).socketTask.close&&(void 0).socketTask.close()}}});n.default=s},e7de:function(t,n,e){"use strict";e("7a82"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default={domain:"http://127.0.0.1:8080"}},e858:function(t,n,e){"use strict";e.r(n);var o=e("d83c"),i=e.n(o);for(var s in o)["default"].indexOf(s)<0&&function(t){e.d(n,t,(function(){return o[t]}))}(s);n["default"]=i.a}}]);